<style>
    #sbody img {
        max-width: 100%;
        max-height: 100vh;
    }

    .stepper-wrapper {
        margin-top: auto;
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .stepper-item {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex: 1;

        @media (max-width: 768px) {
            font-size: 12px;
        }
    }

    .stepper-item::before {
        position: absolute;
        content: "";
        border-bottom: 2px solid #ccc;
        width: 100%;
        top: 20px;
        left: -50%;
        z-index: 2;
    }

    .stepper-item::after {
        position: absolute;
        content: "";
        border-bottom: 2px solid #ccc;
        width: 100%;
        top: 20px;
        left: 50%;
        z-index: 2;
    }

    .stepper-item .step-counter {
        position: relative;
        z-index: 5;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #ccc;
        margin-bottom: 6px;
    }

    .stepper-item.active {
        font-weight: bold;
    }

    .stepper-item.completed .step-counter {
        background-color: #4bb543;
    }

    .stepper-item.completed::after {
        position: absolute;
        content: "";
        border-bottom: 2px solid #4bb543;
        width: 100%;
        top: 20px;
        left: 50%;
        z-index: 3;
    }

    .stepper-item:first-child::before {
        content: none;
    }

    .stepper-item:last-child::after {
        content: none;
    }
</style>

<!-- <div class="btn btn-warning">
    <a href="/blog/add"> Add blog</a>
</div> -->



<div class="container" style="margin: 50px auto;background-color: rgb(253, 240, 220);padding:20px">


    <h1>
        <%= blog["title"] %>
    </h1>

    <div id="blog-status"> By :
        <%= blog["username"] %>

        ,
        <% var x= "just now" ;var y=blog.did;if( time - y >= 525600){ x= (parseInt((time - y )/ 525600))+" years ago"; } else if( time - y >=43200){ x= (parseInt((time - y )/ 43200))+" months ago" } else if( time - y >=10800){ x= (parseInt((time - y )/ 10800))+" weeks ago" }else if( time - y >=1440){ x= (parseInt((time - y )/ 1440))+" days ago" } else if( time - y >=60){ x= (parseInt((time - y )/ 60))+" hours ago" }else if( time - y >=0){ x= (parseInt((time - y )))+" min ago" }   %>
        <% if (x[0] == '0') { x = "Just now" }%>

        <%= x %>
    </div>
    <div id="description" style="margin: 5px">
        <%= blog.description %>
    </div>
    <div style="border-left: 5px grey solid; padding:20px; margin-top: 10px; margin-bottom: 10px; margin-left: 1px;"
        id="body">
        Address:
        <%- blog.sanitizedHtml %>
    </div>


    <div>
        <p>Price: <%= blog.price  %> </p>
    </div>
    <div>
        Property Image: <br>
        <img style="max-width: 100%; max-height: 100%;" src="<%= blog.images %> " alt="property image">
    </div>
    <br>
    <div>
        Property Documents: <br>
        <img style="max-width: 100%; max-height: 100%;" src="<%= blog.doc %> " alt="property image">
    </div>
    <hr>
    <div class="btn btn-warning">
        <a href="/blog/edit/<%=blog['mid']%>">EDIT</a>
    </div>
    <hr>
    <div>

        <p>
            <strong>Status:</strong>
            <strong><%= blog.message %> </strong>
        </p>

        <hr>
        <% if ( blog.status == true || blog.step1 == true ) { %>

        <div class="stepper-wrapper">
            <div
                class="stepper-item   <% if ( blog.step1 == false && blog.status == true ) { %> active <% } else if ( blog.step1 == true ) { %> completed <% } %>  ">
                <div class="step-counter">1</div>
                <div class="step-name">Buyer's Offer Acception </div>
            </div>
            <div
                class="stepper-item <% if ( blog.step2 == false && blog.step1 == true ) { %> active <% } else if ( blog.step2 == true ) { %> completed <% } %> ">
                <div class="step-counter">2</div>
                <div class="step-name">Verifying Seller's Property<br>(Done by Org.)</div>
            </div>
            <div
                class="stepper-item <% if ( blog.step3 == false && blog.step2 == true ) { %> active <% } else if ( blog.step3 == true ) { %> completed <% } %> ">
                <div class="step-counter">3</div>
                <div class="step-name">Funds Checking in Buyer's Account<br>(Done by Org.)</div>
            </div>
            <div
                class="stepper-item <% if ( blog.step4 == false && blog.step3 == true ) { %> active <% } else if ( blog.step4 == true ) { %> completed <% } %> ">
                <div class="step-counter">4</div>
                <div class="step-name">Transfering Ownership to Buyer and Offered Amount to Seller</div>
            </div>
        </div>





        <br><br><br>
        <h5>Transaction Updates</h5>
        <strong>Buyer's Username:</strong> <%= blog.buyer %>
        <br>
        <strong>Buyer's Offered Price:</strong> <%= blog.dealprice %>
        <br>
        <% if ( blog.step1 == false ) { %>
        <p>
            <strong>Buyer's Offer</strong> <span style="color: red;">Rejected</span>
        </p>
        <% } else { %>
        <p>
            <strong>Buyer's Offer</strong> <span style="color: green;">Accepted</span>
        </p>
        <% } %>




        <strong>Status of Verifying Property Details via Org. Records</strong>
        <% if ( blog.step2 == true ) { %>
        <p style="color: green;">Verified</p>
        <% } else { %>
        <p style="color: red;">Pending</p>
        <% } %>



        <strong>Checking Sufficient Funds in Buyer's Account</strong>
        <% if ( blog.step3 == true ) { %>
        <p style="color: green;">Verified</p>
        <% } else { %>
        <p style="color: red;">Pending</p>
        <% } %>



        <strong>Transfering Ownership and Offered Amount</strong>
        <% if ( blog.step4 == true ) { %>
        <p style="color: green;">Verified</p>
        <% } else { %>
        <p style="color: red;">Pending</p>
        <% } %>




        Deal:
        <% if ( blog.deal == false ) { %>
        <p>Pending</p>
        <% } else { %>
        <p>Done</p>
        <% } %>
        <% } %>

    </div>

</div>